// å›½å†…DNSæœåŠ¡å™¨
const domesticNameservers = [
  "https://dns.alidns.com/dns-query", // é˜¿é‡Œäº‘å…¬å…±DNS
  "https://doh.pub/dns-query", // è…¾è®¯DNSPod
  "https://doh.360.cn/dns-query" // 360å®‰å…¨DNS
];
// å›½å¤–DNSæœåŠ¡å™¨
const foreignNameservers = [
  "https://1.1.1.1/dns-query", // Cloudflare(ä¸»)
  "https://1.0.0.1/dns-query", // Cloudflare(å¤‡)
  "https://208.67.222.222/dns-query", // OpenDNS(ä¸»)
  "https://208.67.220.220/dns-query", // OpenDNS(å¤‡)
  "https://194.242.2.2/dns-query", // Mullvad(ä¸»)
  "https://194.242.2.3/dns-query" // Mullvad(å¤‡)
];
// DNSé…ç½®
const dnsConfig = {
  "enable": true,
  "prefer-h3": false,
  "listen": "0.0.0.0:1053",
  "ipv6": true,
  "use-system-hosts": false,
  "cache-algorithm": "arc",
  "enhanced-mode": "fake-ip",
  "fake-ip-range": "198.18.0.1/16",
  "fake-ip-filter": [
    // æœ¬åœ°ä¸»æœº/è®¾å¤‡
    "+.lan",
    "+.local",
    // Windowsç½‘ç»œå‡ºç°å°åœ°çƒå›¾æ ‡
    "+.msftconnecttest.com",
    "+.msftncsi.com",
    // QQå¿«é€Ÿç™»å½•æ£€æµ‹å¤±è´¥
    "localhost.ptlogin2.qq.com",
    "localhost.sec.qq.com",
    // å¾®ä¿¡å¿«é€Ÿç™»å½•æ£€æµ‹å¤±è´¥
    "localhost.work.weixin.qq.com",
    // å…¶ä»–è¿‡æ»¤å™¨
    '*.lan', 'cable.auth.com', '*.msftconnecttest.com', '*.msftncsi.com',
    'network-test.debian.org', 'detectportal.firefox.com', 'resolver1.opendns.com',
    '*.srv.nintendo.net', '*.stun.playstation.net', 'xbox.*.microsoft.com',
    '*.xboxlive.com', 'stun.*', 'global.turn.twilio.com', 'global.stun.twilio.com',
    'localhost.*.qq.com', 'localhost.*.weixin.qq.com', '*.logon.battlenet.com.cn',
    '*.logon.battle.net', '*.blzstatic.cn', 'music.163.com', '*.music.163.com',
    '*.126.net', 'musicapi.taihe.com', 'music.taihe.com', 'songsearch.kugou.com',
    'trackercdn.kugou.com', '*.kuwo.cn', 'api-jooxtt.sanook.com', 'api.joox.com',
    'joox.com', 'y.qq.com', '*.y.qq.com', 'streamoc.music.tc.qq.com',
    'mobileoc.music.tc.qq.com', 'isure.stream.qqmusic.qq.com', 'dl.stream.qqmusic.qq.com',
    'aqqmusic.tc.qq.com', 'amobile.music.tc.qq.com', '*.xiami.com',
    '*.music.migu.cn', 'music.migu.cn', 'proxy.golang.org', '*.mcdn.bilivideo.cn',
    '*.cmpassport.com', 'id6.me', 'open.e.189.cn', 'mdn.open.wo.cn', 'opencloud.wostore.cn',
    'auth.wosms.cn', '*.jegotrip.com.cn', '*.icitymobile.mobi', '*.pingan.com.cn',
    '*.cmbchina.com', 'pool.ntp.org', '*.pool.ntp.org', 'ntp.*.com', 'time.*.com',
    'ntp?.*.com', 'time?.*.com', 'time.*.gov', 'time.*.edu.cn', '*.ntp.org.cn',
    'PDC._msDCS.*.*', 'DC._msDCS.*.*', 'GC._msDCS.*.*'
  ],
  "default-nameserver": ["223.5.5.5", "119.29.29.29", "1.1.1.1", "8.8.8.8"],
  "nameserver": [...domesticNameservers, ...foreignNameservers],
  "proxy-server-nameserver": [...domesticNameservers, ...foreignNameservers],
  "nameserver-policy": {
    "geosite:private,cn,geolocation-cn": domesticNameservers,
    "geosite:google,youtube,telegram,gfw,geolocation-!cn": foreignNameservers
  }
};
// è§„åˆ™é›†é€šç”¨é…ç½®
const ruleProviderCommon = {
  "type": "http",
  "behavior": "classical",
  "format": "text",
  "interval": 86400
};
const ruleProvideDomain = {
  "type": "http",
  "behavior": "domain",
  "format": "mrs",
  "interval": 86400
};
const ruleProvideIpcidr = {
  "type": "http",
  "behavior": "ipcidr",
  "format": "mrs",
  "interval": 86400
};
// è§„åˆ™é›†é…ç½®
const ruleProviders = {
  "private-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/private-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.mrs"
  },
  "private-ip": {
    ...ruleProvideIpcidr,
    "path": "./ruleset/private-ip.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/private.mrs"
  },
  "ai-classical": {
    ...ruleProviderCommon,
    "path": "./ruleset/openai-classical.list",
    "url": "https://raw.gitmirror.com/Coldvvater/Mononoke/master/Clash/Rules/AI.list"
  },
  "youtube-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/youtube-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.mrs"
  },
  "netflix-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/netflix-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.mrs"
  },
  "netflix-ip": {
    ...ruleProvideIpcidr,
    "path": "./ruleset/netflix-ip.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/netflix.mrs"
  },
  "emby-classical": {
    ...ruleProviderCommon,
    "path": "./ruleset/emby-classical.list",
    "url": "https://raw.gitmirror.com/Coldvvater/Mononoke/master/Clash/Rules/Emby.list"
  },
  "bahamut-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/bahamut-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bahamut.mrs"
  },
  "biliintl-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/biliintl-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/biliintl.mrs"
  },
  "bilibili-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/bilibili-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bilibili.mrs"
  },
  "bilibili-ip": {
    ...ruleProvideIpcidr,
    "path": "./ruleset/bilibili-ip.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo-lite/geoip/bilibili.mrs"
  },
  "spotify-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/spotify-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/spotify.mrs"
  },
  "neteasemusic-classical": {
    ...ruleProviderCommon,
    "path": "./ruleset/neteasemusic-classical.list",
    "url": "https://raw.gitmirror.com/Coldvvater/Mononoke/master/Clash/Rules/NetEaseMusic.list"
  },
  "tiktok-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/tiktok-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/tiktok.mrs"
  },
  "streamingmedia-classical": {
    ...ruleProviderCommon,
    "path": "./ruleset/streamingmedia-classical.list",
    "url": "https://raw.gitmirror.com/Coldvvater/Mononoke/master/Clash/Rules/ProxyMedia.list"
  },
  "telegram-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/telegram-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.mrs"
  },
  "telegram-ip": {
    ...ruleProvideIpcidr,
    "path": "./ruleset/telegram-ip.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.mrs"
  },
  "github-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/github-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/github.mrs"
  },
  "twitter-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/twitter-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/twitter.mrs"
  },
  "twitter-ip": {
    ...ruleProvideIpcidr,
    "path": "./ruleset/twitter-ip.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/twitter.mrs"
  },
  "apple-classical": {
    ...ruleProviderCommon,
    "path": "./ruleset/apple-classical.list",
    "url": "https://raw.gitmirror.com/Coldvvater/Mononoke/master/Clash/Rules/AppleProxyService.list"
  },
  "apple-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/apple-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/apple.mrs"
  },
  "apple-ip": {
    ...ruleProvideIpcidr,
    "path": "./ruleset/apple-ip.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo-lite/geoip/apple.mrs"
  },
  "google-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/google-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.mrs"
  },
  "google-ip": {
    ...ruleProvideIpcidr,
    "path": "./ruleset/google-ip.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.mrs"
  },
  "microsoft-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/microsoft-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/microsoft.mrs"
  },
  "games-classical": {
    ...ruleProviderCommon,
    "path": "./ruleset/games-classical.list",
    "url": "https://raw.gitmirror.com/Coldvvater/Mononoke/master/Clash/Rules/Game.list"
  },
  "cn-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/cn-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs"
  },
  "proxy-domain": {
    ...ruleProvideDomain,
    "path": "./ruleset/proxy-domain.list",
    "url": "https://raw.gitmirror.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.mrs"
  }
};
// è§„åˆ™
const rules = [
  // è‡ªå®šä¹‰è§„åˆ™
  "DOMAIN-SUFFIX,clash.razord.top,DIRECT", // clash.razord.top ç›´è¿
  "DOMAIN-SUFFIX,yacd.metacubex.one,DIRECT", // yacd.metacubex.one ç›´è¿
  "DOMAIN-SUFFIX,yacd.haishan.me,DIRECT", // yacd.haishan.me ç›´è¿
  "DOMAIN-SUFFIX,d.metacubex.one,DIRECT", // d.metacubex.one ç›´è¿
  "DOMAIN-SUFFIX,raw.gitmirror.com,Proxy", // raw.gitmirror.com ä»£ç†

  // è§„åˆ™é›†
  "RULE-SET,private-domain,DIRECT", // ç§æœ‰åŸŸç›´è¿
  "RULE-SET,ai-classical,AIGC", // AIå¤å…¸è§„åˆ™é›†
  "RULE-SET,youtube-domain,YouTube", // YouTube åŸŸåè§„åˆ™é›†
  "RULE-SET,netflix-domain,NETFLIX", // Netflix åŸŸåè§„åˆ™é›†
  "RULE-SET,emby-classical,Emby", // Emby å¤å…¸è§„åˆ™é›†
  "RULE-SET,bahamut-domain,TaiWan", // å·´å“ˆå§†ç‰¹åŸŸåè§„åˆ™é›†
  "RULE-SET,biliintl-domain,Streaming", // å›½é™…ç‰ˆå“”å“©å“”å“©åŸŸåè§„åˆ™é›†
  "RULE-SET,bilibili-domain,BiliBili", // å“”å“©å“”å“©åŸŸåè§„åˆ™é›†
  "RULE-SET,spotify-domain,Spotify", // Spotify åŸŸåè§„åˆ™é›†
  "RULE-SET,neteasemusic-classical,NetEaseMusic", // ç½‘æ˜“äº‘éŸ³ä¹å¤å…¸è§„åˆ™é›†
  "RULE-SET,tiktok-domain,TikTok", // TikTok åŸŸåè§„åˆ™é›†
  "RULE-SET,streamingmedia-classical,Streaming", // æµåª’ä½“å¤å…¸è§„åˆ™é›†
  "RULE-SET,telegram-domain,Telegram", // Telegram åŸŸåè§„åˆ™é›†
  "RULE-SET,github-domain,Proxy", // GitHub åŸŸåè§„åˆ™é›†
  "RULE-SET,twitter-domain,X", // Twitter åŸŸåè§„åˆ™é›†
  "RULE-SET,apple-classical,Proxy", // è‹¹æœå¤å…¸è§„åˆ™é›†
  "RULE-SET,apple-domain,Apple", // è‹¹æœåŸŸåè§„åˆ™é›†
  "RULE-SET,google-domain,Google", // Google åŸŸåè§„åˆ™é›†
  "RULE-SET,microsoft-domain,Microsoft", // å¾®è½¯åŸŸåè§„åˆ™é›†
  "RULE-SET,games-classical,Games", // æ¸¸æˆå¤å…¸è§„åˆ™é›†
  "RULE-SET,proxy-domain,Proxy", // ä»£ç†åŸŸåè§„åˆ™é›†

  // IP è§„åˆ™é›†
  "RULE-SET,google-ip,Google", // Google IP è§„åˆ™é›†
  "RULE-SET,netflix-ip,NETFLIX", // Netflix IP è§„åˆ™é›†
  "RULE-SET,telegram-ip,Telegram", // Telegram IP è§„åˆ™é›†
  "RULE-SET,twitter-ip,X", // Twitter IP è§„åˆ™é›†
  "RULE-SET,cn-domain,DIRECT", // ä¸­å›½åŸŸåç›´è¿
  "RULE-SET,bilibili-ip,BiliBili", // å“”å“©å“”å“© IP è§„åˆ™é›†
  "RULE-SET,apple-ip,Apple", // è‹¹æœ IP è§„åˆ™é›†
  "RULE-SET,private-ip,DIRECT", // ç§æœ‰ IP ç›´è¿
  "GEOIP,CN,DIRECT", // ä¸­å›½ IP ç›´è¿

  // å…¶ä»–è§„åˆ™
  "MATCH,Final" // æœ€ç»ˆåŒ¹é…è§„åˆ™
];
// ä»£ç†ç»„é€šç”¨é…ç½®
const HK = '^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|Hong)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$';
const TW = '^(?=.*((?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|(\b(TW|Tai|Taiwan)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
const JP = '^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|Japan)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
const KR = '^(?=.*((?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“|é¦–å°”|(\b(KR|Korea)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
const SG = '^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
const US = '^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|United States)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
const UK = '^(?=.*((?i)ğŸ‡¬ğŸ‡§|è‹±å›½|ä¼¦æ•¦|(\b(UK|United Kingdom)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
const All = '^(?=.*(.))(?!.*((?i)ç¾¤|é‚€è¯·|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|(\b(USE|USED|TOTAL|Traffic|Expire|EMAIL|Panel|Channel|Author)\b|(\d{4}-\d{2}-\d{2}|\d+G)))).*$'

const groupSelect = {
  "type": "select",
  // "proxies": [Proxy, HongKong, TaiWan, Japan, Korea, Singapore, America, UnitedKingdom, AllServer, DIRECT]
};
const groupUrlTest = {
  "type": "url-test",
  "interval": 300,
  "tolerance": 20,
  "lazy": true,
  "url": "http://cp.cloudflare.com",
  "disable-udp": false,
  "timeout": 2000,
  "max-failed-times": 3,
  "hidden": true,
  "include-all-providers": true
};
const groupFallBack = {
  "type": "fallback",
  "interval": 300,
  "lazy": true,
  "url": "http://cp.cloudflare.com",
  "disable-udp": false,
  "timeout": 2000,
  "max-failed-times": 3,
  "hidden": true,
  "include-all-providers": true
};
const groupLoadBalance = {
  "type": "load-balance",
  "interval": 300,
  "lazy": true,
  "url": "http://cp.cloudflare.com",
  "disable-udp": false,
  "strategy": "consistent-hashing",
  "timeout": 2000,
  "max-failed-times": 3,
  "hidden": true,
  "include-all-providers": true
};

// ç¨‹åºå…¥å£
function main(config) {
  const proxyCount = config?.proxies?.length ?? 0;
  const proxyProviderCount =
    typeof config?.["proxy-providers"] === "object" ? Object.keys(config["proxy-providers"]).length : 0;
  if (proxyCount === 0 && proxyProviderCount === 0) {
    throw new Error("é…ç½®æ–‡ä»¶ä¸­æœªæ‰¾åˆ°ä»»ä½•ä»£ç†");
  }

  // è¦†ç›–åŸé…ç½®ä¸­DNSé…ç½®
  config["dns"] = dnsConfig;

  // è¦†ç›–åŸé…ç½®ä¸­çš„ä»£ç†ç»„
  config["proxy-groups"] = [
    // åœ°åŒºèŠ‚ç‚¹ä»£ç†ç»„
    {
      name: "HongKong",
      icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png",
      type: "select",
      proxies: ["HK-Auto", "HK-FallBack", "HK-LoadBalance"],
      includeAllProviders: true,
      filter: HK
    },
    {
      name: "TaiWan",
      icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/China.png",
      type: "select",
      proxies: ["TW-Auto", "TW-FallBack", "TW-LoadBalance"],
      includeAllProviders: true,
      filter: TW
    },
    {
      name: "Japan",
      icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Japan.png",
      type: "select",
      proxies: ["JP-Auto", "JP-FallBack", "JP-LoadBalance"],
      includeAllProviders: true,
      filter: JP
    },
    {
      name: "Korea",
      icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Korea.png",
      type: "select",
      proxies: ["KR-Auto", "KR-FallBack", "KR-LoadBalance"],
      includeAllProviders: true,
      filter: KR
    },
    {
      name: "Singapore",
      icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Singapore.png",
      type: "select",
      proxies: ["SG-Auto", "SG-FallBack", "SG-LoadBalance"],
      includeAllProviders: true,
      filter: SG
    },
    {
      name: "America",
      icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/United_States.png",
      type: "select",
      proxies: ["US-Auto", "US-FallBack", "US-LoadBalance"],
      includeAllProviders: true,
      filter: US
    },
    {
      name: "UnitedKingdom",
      icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/United_Kingdom.png",
      type: "select",
      proxies: ["UK-Auto", "UK-FallBack", "UK-LoadBalance"],
      includeAllProviders: true,
      filter: UK
    },

    // å…¨éƒ¨èŠ‚ç‚¹
    {
      name: "AllServer",
      icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Airport.png",
      type: "select",
      includeAllProviders: true,
      filter: All
    },
    // æ¼ç½‘ä¹‹é±¼
    { name: "Final", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Final.png", ...groupSelect, proxies: ["Proxy", "DIRECT"] },
    // èŠ‚ç‚¹åˆ‡æ¢
    { name: "Proxy", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Rocket.png", ...groupSelect, proxies: ["HongKong", "TaiWan", "Japan", "Korea", "Singapore", "America", "UnitedKingdom", "AllServer", "DIRECT"] },
    // AIå¹³å°
    { name: "AIGC", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/ChatGPT.png", ...groupSelect },
    // YouTube
    { name: "YouTube", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/YouTube.png", ...groupSelect },
    // Netflix
    { name: "NETFLIX", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Netflix.png", ...groupSelect },
    // Emby
    { name: "Emby", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Emby.png", ...groupSelect },
    // å“”å“©å“”å“©
    { name: "BiliBili", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/bilibili_3.png", ...groupSelect, proxies: ["DIRECT", "HongKong", "TaiWan"] },
    // Spotify
    { name: "Spotify", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Spotify.png", ...groupSelect },
    // ç½‘æ˜“äº‘éŸ³ä¹
    { name: "NetEaseMusic", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Netease_Music.png", ...groupSelect, proxies: ["DIRECT"] },
    // TikTok
    { name: "TikTok", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/TikTok.png", ...groupSelect },
    // å›½é™…æµåª’ä½“
    { name: "Streaming", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Streaming.png", ...groupSelect },
    // Telegram
    { name: "Telegram", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Telegram_X.png", ...groupSelect },
    // X(Twitter)
    { name: "X", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/X.png", ...groupSelect },
    // è‹¹æœæœåŠ¡
    { name: "Apple", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Apple_1.png", ...groupSelect },
    // è°·æ­ŒæœåŠ¡
    { name: "Google", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Google_Search.png", ...groupSelect },
    // å¾®è½¯æœåŠ¡
    { name: "Microsoft", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Windows_11.png", ...groupSelect },
    // æ¸¸æˆå¹³å°
    { name: "Games", icon: "https://raw.gitmirror.com/Koolson/Qure/master/IconSet/Color/Game.png", ...groupSelect },
    

    // å»¶æ—¶ä¼˜é€‰ä»£ç†ç»„
    { name: "HK-Auto", ...groupUrlTest, filter: HK },
    { name: "TW-Auto", ...groupUrlTest, filter: TW },
    { name: "JP-Auto", ...groupUrlTest, filter: JP },
    { name: "KR-Auto", ...groupUrlTest, filter: KR },
    { name: "SG-Auto", ...groupUrlTest, filter: SG },
    { name: "US-Auto", ...groupUrlTest, filter: US },
    { name: "UK-Auto", ...groupUrlTest, filter: UK },

    // æ•…éšœè½¬ç§»ä»£ç†ç»„
    { name: "HK-FallBack", ...groupFallBack, filter: HK },
    { name: "TW-FallBack", ...groupFallBack, filter: TW },
    { name: "JP-FallBack", ...groupFallBack, filter: JP },
    { name: "KR-FallBack", ...groupFallBack, filter: KR },
    { name: "SG-FallBack", ...groupFallBack, filter: SG },
    { name: "US-FallBack", ...groupFallBack, filter: US },
    { name: "UK-FallBack", ...groupFallBack, filter: UK },

    // è´Ÿè½½å‡è¡¡ä»£ç†ç»„
    { name: "HK-LoadBalance", ...groupLoadBalance, filter: HK },
    { name: "TW-LoadBalance", ...groupLoadBalance, filter: TW },
    { name: "JP-LoadBalance", ...groupLoadBalance, filter: JP },
    { name: "KR-LoadBalance", ...groupLoadBalance, filter: KR },
    { name: "SG-LoadBalance", ...groupLoadBalance, filter: SG },
    { name: "US-LoadBalance", ...groupLoadBalance, filter: US },
    { name: "UK-LoadBalance", ...groupLoadBalance, filter: UK }
  ];

  // è¦†ç›–åŸé…ç½®ä¸­çš„è§„åˆ™
  config["rule-providers"] = ruleProviders;
  config["rules"] = rules;

  config["port"] = 7890;                           // HTTP(S) ä»£ç†æœåŠ¡å™¨ç«¯å£
  config["socks-port"] = 7891;                     // SOCKS5 ä»£ç†ç«¯å£
  config["mixed-port"] = 7892;                     // æ··åˆç«¯å£ï¼ŒHTTPå’ŒSOCKS5ç”¨ä¸€ä¸ªç«¯å£
  config["redir-port"] = 7893;                     // é€æ˜ä»£ç†ç«¯å£ï¼Œç”¨äº Linux å’Œ MacOS
  config["tproxy-port"] = 7894;                    // Transparent proxy server port for Linux (TProxy TCP and TProxy UDP)

  config["mode"] = "rule";                          // è§„åˆ™æ¨¡å¼ï¼šruleï¼ˆè§„åˆ™ï¼‰ / globalï¼ˆå…¨å±€ä»£ç†ï¼‰/ directï¼ˆå…¨å±€ç›´è¿ï¼‰/ script (è„šæœ¬)
  config["log-level"] = "info";                     // è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ« (5 ä¸ªçº§åˆ«ï¼šsilent / error / warning / info / debugï¼‰
  config["allow-lan"] = True;                      // å…è®¸å±€åŸŸç½‘çš„è¿æ¥ï¼ˆå…±äº«ä»£ç†ï¼‰
  config["bind-address"] = "*";                    // ç›‘å¬IPç™½åå•ï¼Œå¯ç»‘å®šå•ä¸ªIPv4å’Œv6åœ°å€ï¼Œ"*" ä¸ºç»‘å®šæ‰€æœ‰IPåœ°å€ï¼Œä»…åœ¨å°†allow-lanè®¾ç½®ä¸ºtrueæ—¶é€‚ç”¨
  config["ipv6"] = True;                           // å¼€å¯ IPv6 æ€»å¼€å…³ï¼Œå…³é—­é˜»æ–­æ‰€æœ‰ IPv6 é“¾æ¥å’Œå±è”½ DNS è¯·æ±‚ AAAA è®°å½•
  config["udp"] = True;                            // æ˜¯å¦å…è®¸ UDP é€šè¿‡ä»£ç†ï¼Œé»˜è®¤ä¸º false

  config["unified-delay"] = True;                  // å¼€å¯ç»Ÿä¸€å»¶è¿Ÿæ—¶ï¼Œä¼šè¿›è¡Œä¸¤æ¬¡å»¶è¿Ÿæµ‹è¯•ï¼Œä»¥æ¶ˆé™¤è¿æ¥æ¡æ‰‹ç­‰å¸¦æ¥çš„ä¸åŒç±»å‹èŠ‚ç‚¹çš„å»¶è¿Ÿå·®å¼‚ï¼Œå¯é€‰å€¼ true/false
  config["tcp-concurrent"] = True;                 // TCP å¹¶å‘ï¼Œå¯é€‰å€¼ true/false
  config["find-process-mode"] = "strict";          // æ§åˆ¶æ˜¯å¦è®© Clash å»åŒ¹é…è¿›ç¨‹ï¼Œalways å¼€å¯ï¼Œå¼ºåˆ¶åŒ¹é…æ‰€æœ‰è¿›ç¨‹ï¼Œstrict é»˜è®¤ï¼Œç”± Clash åˆ¤æ–­æ˜¯å¦å¼€å¯ï¼Œoff ä¸åŒ¹é…è¿›ç¨‹ï¼Œæ¨èåœ¨è·¯ç”±å™¨ä¸Šä½¿ç”¨æ­¤æ¨¡å¼
  config["global-client-fingerprint"] = "chrome"; // å…¨å±€ TLS æŒ‡çº¹ï¼Œä¼˜å…ˆä½äº proxy å†…çš„ client-fingerprintï¼Œç›®å‰æ”¯æŒå¼€å¯ TLS ä¼ è¾“çš„ TCP/grpc/WS/HTTP , æ”¯æŒåè®®æœ‰ VLESS,Vmess å’Œ trojan

  config["external-controller"] = "127.0.0.1:9090"; // å¤–éƒ¨æ§åˆ¶å™¨ï¼Œå¯ä»¥ä½¿ç”¨ RESTful API æ¥æ§åˆ¶ä½ çš„ Clash å†…æ ¸ï¼ŒAPI ç›‘å¬åœ°å€ï¼Œä½ å¯ä»¥å°† 127.0.0.1 ä¿®æ”¹ä¸º 0.0.0.0 æ¥ç›‘å¬æ‰€æœ‰ IP
  config["external-ui"] = "ui";                    // å¯ä»¥å°†é™æ€ç½‘é¡µèµ„æº (æ¯”å¦‚ Clash-dashboard) è¿è¡Œåœ¨ Clash API, è·¯å¾„ä¸º API åœ°å€/uiï¼Œå¯ä»¥ä¸ºç»å¯¹è·¯å¾„ï¼Œæˆ–è€… Clash å·¥ä½œç›®å½•çš„ç›¸å¯¹è·¯å¾„
  config["external-ui-url"] = 'https://mirror.ghproxy.com/https://github.com/MetaCubeX/Yacd-meta/archive/gh-pages.zip'; // å¤–éƒ¨ UI çš„ URL

  config["geodata-mode"] = false;                  // æ›´æ”¹ geoip ä½¿ç”¨æ–‡ä»¶ï¼Œmmdb æˆ–è€… datï¼Œå¯é€‰ true/false,trueä¸º datï¼Œæ­¤é¡¹æœ‰é»˜è®¤å€¼ false
  config["geodata-loader"] = "memconservative";     // GEO æ–‡ä»¶åŠ è½½æ¨¡å¼ï¼Œstandardï¼šæ ‡å‡†åŠ è½½å™¨ memconservativeï¼šä¸“ä¸ºå†…å­˜å—é™ (å°å†…å­˜) è®¾å¤‡ä¼˜åŒ–çš„åŠ è½½å™¨ (é»˜è®¤å€¼)
  config["geo-auto-update"] = true;                 // è‡ªåŠ¨æ›´æ–° GEO
  config["geo-update-interval"] = 24;               // æ›´æ–°é—´éš”ï¼Œå•ä½ä¸ºå°æ—¶
  config["geox-url"] = {
    "mmdb": 'https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.metadb',
    "asn": 'https://mirror.ghproxy.com/https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb'
    // è‡ªå®šä¹‰ GEO ä¸‹è½½åœ°å€
  };

  config["profile"] = {
    "store-selected": true,               // å‚¨å­˜ API å¯¹ç­–ç•¥ç»„çš„é€‰æ‹©ï¼Œä»¥ä¾›ä¸‹æ¬¡å¯åŠ¨æ—¶ä½¿ç”¨
    "store-fake-ip": true                 // å‚¨å­˜ fakeip æ˜ å°„è¡¨ï¼ŒåŸŸåå†æ¬¡å‘ç”Ÿè¿æ¥æ—¶ï¼Œä½¿ç”¨åŸæœ‰æ˜ å°„åœ°å€
  };

  config["sniffer"] = {
    "enable": true,                       // æ˜¯å¦å¯ç”¨sniffer
    "force-dns-mapping": true,            // å¯¹ redir-host ç±»å‹è¯†åˆ«çš„æµé‡è¿›è¡Œå¼ºåˆ¶å—…æ¢
    "parse-pure-ip": true,                // å¯¹æ‰€æœ‰æœªè·å–åˆ°åŸŸåçš„æµé‡è¿›è¡Œå¼ºåˆ¶å—…æ¢
    "override-destination": true,         // æ˜¯å¦ä½¿ç”¨å—…æ¢ç»“æœä½œä¸ºå®é™…è®¿é—®ï¼Œé»˜è®¤ä¸º true
    "sniff": {
      "HTTP": {
        "ports": [80, 8080 - 8880],        // portså­—æ®µï¼Œè¡¨ç¤ºç«¯å£èŒƒå›´ã€‚ç¤ºä¾‹ï¼šports: [80, 8080-8880]
        "override-destination": true     // override-destinationå­—æ®µï¼ˆå¯é€‰ï¼‰ï¼Œç”¨äºè¦†ç›–å…¨å±€override-destinationè®¾ç½®
      },
      "TLS": {
        "ports": [443, 8443]
      },
      "QUIC": {
        "ports": [443, 8443]
      }
    },
    "force-domain": [                     // éœ€è¦å¼ºåˆ¶å—…æ¢çš„åŸŸåï¼ˆé»˜è®¤æƒ…å†µä¸‹åªå¯¹IPè¿›è¡Œå—…æ¢ï¼‰
      "+.v2ex.com"
    ],
    "skip-domain": [                      // éœ€è¦è·³è¿‡å—…æ¢çš„åŸŸåã€‚ä¸»è¦è§£å†³éƒ¨åˆ†ç«™ç‚¹sniå­—æ®µéåŸŸåï¼Œå¯¼è‡´å—…æ¢ç»“æœå¼‚å¸¸çš„é—®é¢˜ï¼Œå¦‚ç±³å®¶è®¾å¤‡Mijia Cloud
      "Mijia Cloud"
    ]
  };

  config["tun"] = {
    "enable": false,                      // å¯ç”¨ tun
    "stack": "system",                    // tun æ¨¡å¼å †æ ˆ,å¯ç”¨å€¼ï¼šsystem/gvisor/mixed
    "dns-hijack": [                      // dns åŠ«æŒï¼Œå°†åŒ¹é…åˆ°çš„è¿æ¥å¯¼å…¥å†…éƒ¨ dns æ¨¡å—ï¼Œä¸ä¹¦å†™åè®®åˆ™ä¸º udp://
      "any:53"
    ],
    "auto-route": true,                   // è‡ªåŠ¨è®¾ç½®å…¨å±€è·¯ç”±ï¼Œå¯ä»¥è‡ªåŠ¨å°†å…¨å±€æµé‡è·¯ç”±è¿›å…¥ tun ç½‘å¡
    "auto-detect-interface": true         // è‡ªåŠ¨é€‰æ‹©æµé‡å‡ºå£æ¥å£ï¼Œå¤šå‡ºå£ç½‘å¡åŒæ—¶è¿æ¥çš„è®¾å¤‡å»ºè®®æ‰‹åŠ¨æŒ‡å®šå‡ºå£ç½‘å¡
  };

  // è¿”å›ä¿®æ”¹åçš„é…ç½®
  return config;
}